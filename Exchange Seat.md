# _Exchange Seat_

```sql
DECLARE @MAX INT
SELECT @MAX = max(id) from Seat;
SELECT
    id,
    case
        when id = @MAX and @MAX %2 <> 0 then student
        when id %2 <> 0 then lead(student) over (order by id)
        when id %2 = 0 then lag(student) over (order by id)
        else student
        end as student
FROM Seat
GROUP BY id, student
order by id ASC
```
هنبدل الاسم بتاع كل 2 id متتاليين مع بعض، هنقسم كل صفين متتالين من خلال اننا نصنفهم لعدد فردي وزوجي

## شرح الcase : 
_```لو الid باقي قسمته على 2 لا يساوي 0 ( يعني عدد فردي ) يبقى اعرض قيمة studetn من الصف اللي بعده```_

_```لو الid باقي قسمته على 2 يساوي 0 ( يعني عدد زوجي ) يبقى اعرض قيمة student من الصف اللي قبله```_

كدا بدلنا كل اتنين مع بعض

فاضل الشرط الاخير ان لو اخر صف الid بتاعه فردي يبقى ماتبدلش القيمة
افترضت ان في variable اسمه ```@MAX``` بيساوي على قيمة id ( اللي هو يمثل اخر صف )

هنضيف الشرط دا في الcase : 
لو اعلى قيمة في الجدول (@MAX) عدد فردي يبقى اعرض student بتاع الصف الحالي بدون تبديل


هنا ضروري جدا نكتب الشرط اللي فيه @MAX كأول شرط في الـ CASE لأنه حالة خاصة واستثناء

لو كتبناه بعد الشروط التانية مش هيتنفذ لأن الشروط اللي قبله (زي id % 2 <> 0) هتكون اتحققت وخدت الأولوية

ف ممكن نقول قاعدة إن  ```*أي استثناء أو حالة شاذة لازم يتحط في الأول عشان ما يتغطاش بالشروط اللي قبله*```
